:root{
  --bg:#0e1a12;
  --felt:#14341f;
  --felt-2:#0f2a19;
  --ink:#eaf6ed;
  --muted:#cfe5d4;
  --accent:#7be495;
  --danger:#ff8a8a;
  --slot:#1e3b28;
  --card:#173b2a;
  --card-edge:#2a6d4a;
  --shadow: 0 8px 24px rgba(0,0,0,.35);

  --card-w: min(clamp(88px, 14vw, 120px), clamp(88px, 24vh, 120px));
  --card-h: calc(var(--card-w) * 1.333);
  --slot-h: var(--card-h);
  --gap: clamp(6px, 1.6vw, 18px);
  --radius: 14px;
}

/* ===== Pantalla estable (sin scroll/“rebote”) ===== */
*{box-sizing:border-box}
html,body{
  height:100dvh;                 /* viewport real en móviles */
  overflow:hidden;               /* sin scroll */
  overscroll-behavior: none;     /* sin “rebote” */
}
body{
  margin:0;
  font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  color:var(--ink);
  background:
    radial-gradient(1200px 600px at 50% -200px, #1d4d33 0%, transparent 60%),
    linear-gradient(180deg, var(--bg), #0b1410 60%, #080f0b);
}

/* Evita gestos nativos durante el drag */
.board, .lane, .slot, .hand, .card, .zoom{ touch-action:none; }
img{ -webkit-user-drag:none; user-select:none; -webkit-user-select:none }

/* --- cartel de turno --- */
.turn-banner{
  position:fixed;top:10px;left:50%;
  transform:translateX(-50%);
  background:rgba(0,0,0,.55);
  backdrop-filter:blur(4px);
  border:1px solid rgba(255,255,255,.15);
  color:var(--ink);
  padding:8px 14px;border-radius:12px;font-weight:800;z-index:20;
  opacity:0; transition:opacity .25s, transform .25s;
  font-size:clamp(.9rem, 2vw, 1rem);
}
.turn-banner.show{opacity:1;transform:translateX(-50%)}
.hidden{display:none}

/* --- topbar --- */
.topbar{
  display:grid; grid-template-columns:1fr auto 1fr; align-items:center; gap:12px;
  padding:10px clamp(10px, 3vw, 24px);
  border-bottom:1px solid rgba(255,255,255,.06);
  background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,0));
  position:sticky;top:0;z-index:5;
}
.side{display:flex;align-items:center;gap:10px}
.side-right{justify-content:flex-end}
.name{opacity:.9;letter-spacing:.3px;font-size:clamp(.9rem, 1.8vw, 1rem)}

.pollution{
  width:clamp(42px, 6vw, 56px); height:clamp(42px, 6vw, 56px);
  border-radius:50%; display:grid;place-items:center;
  background:radial-gradient(circle at 30% 30%, #2c6b49, #123822);
  box-shadow:inset 0 0 0 3px var(--accent),var(--shadow);
  font-weight:700;font-variant-numeric:tabular-nums;font-size:clamp(.9rem, 2.2vw, 1rem);
}
.pollution.hit{animation:pop 420ms ease}
@keyframes pop{0%{transform:scale(1)}40%{transform:scale(1.12)}100%{transform:scale(1)}}

.timer-wrap{text-align:center}
.timer-label{opacity:.8;font-size:clamp(.8rem, 1.8vw, .9rem)}
#timer{font-size:clamp(1.2rem, 3vw, 1.8rem);font-weight:800;letter-spacing:.5px}
.rule{opacity:.75;font-size:clamp(.75rem, 1.7vw, .85rem)}

/* --- tablero --- */
.board{
  max-width:min(1100px, 98vw);
  margin: clamp(6px, 2.4vw, 20px) auto;
  background:radial-gradient(900px 500px at 50% -120px,var(--felt),var(--felt-2));
  border-radius:20px;
  padding: clamp(8px, 2.2vw, 20px);
  box-shadow:var(--shadow);
  border:1px solid rgba(255,255,255,.06);
}

.lane{
  display:grid; grid-template-columns: repeat(5, 1fr);
  gap: var(--gap); padding: var(--gap);
}

.slot{
  position:relative; height: var(--slot-h); border-radius:var(--radius);
  background:linear-gradient(180deg, rgba(255,255,255,.06), transparent 40%),
             linear-gradient(0deg, rgba(0,0,0,.25), rgba(0,0,0,.1));
  outline:2px dashed rgba(255,255,255,.12); outline-offset:-8px;
  display:grid;place-items:center; color:var(--muted); user-select:none; overflow:hidden;
}
.slot.own-target{outline-color:var(--accent);filter:drop-shadow(0 0 10px rgba(123,228,149,.35))}
.slot.enemy-target{outline-color:var(--danger)}
.slot.flash{animation:slotFlash 420ms ease}
@keyframes slotFlash{0%{box-shadow:0 0 0 0 rgba(123,228,149,0)}40%{box-shadow:0 0 18px 6px rgba(123,228,149,.45)}100%{box-shadow:0 0 0 0 rgba(123,228,149,0)}}

/* --- carta --- */
.card{
  position:relative; background:var(--card); border:2px solid var(--card-edge);
  color:var(--ink); width: var(--card-w); height: var(--card-h);
  border-radius:var(--radius); box-shadow:var(--shadow); cursor:pointer;
  outline:3px solid transparent; user-select:none;
  transition:transform .12s, box-shadow .12s, outline-color .12s;
  display:flex; overflow:hidden;
}
.card:hover{transform:translateY(-4px)}
.card.selected{outline-color:var(--accent);transform:translateY(-6px)}

.card-inner{
  position:relative; display:flex; flex-direction:column; justify-content:space-between;
  padding: clamp(8px, 1.2vw, 10px); width:100%; height:100%;
}

/* imagen centrada y contenida */
.card-img{
  position:absolute; inset: clamp(8px, 1.2vw, 10px);
  width:auto;height:auto;
  max-width: calc(100% - clamp(16px, 2.4vw, 20px));
  max-height: calc(100% - clamp(16px, 2.4vw, 20px));
  object-fit: contain !important;
  object-position: center center !important;
  border-radius:8px; z-index:1; pointer-events:none;
}

/* velo para legibilidad */
.card.has-image::after{
  content:""; position:absolute; inset:0; z-index:1;
  border-radius:var(--radius);
  background:linear-gradient(180deg,rgba(0,0,0,.12),rgba(0,0,0,.35));
  pointer-events:none;
}

/* textos por encima */
.card .title,.card .number,.card .tag{ position:relative; z-index:2; }

/* === Título centrado con espacio reservado para el número === */
.card .title{
  font-weight:700; font-size: clamp(.9rem, 2.1vw, 1rem);
  text-align:center;
  padding-right: clamp(28px, 8vw, 44px); /* espacio para no chocar con el número */
  padding-left: .4em;
}

/* Número arriba a la derecha */
.card .number{
  position:absolute;
  top: clamp(6px, 1.2vw, 10px);
  right: clamp(6px, 1.2vw, 10px);
  font-size: clamp(1rem, 2.6vw, 1.4rem);
  font-weight:900; line-height:1;
  background:rgba(0,0,0,.35);
  padding: 4px 8px; border-radius:8px;
  font-variant-numeric: tabular-nums;
}

/* etiqueta inferior */
.card .tag{
  font-size: clamp(.7rem, 1.8vw, .8rem);
  opacity:.95; text-align:center;
  background:rgba(0,0,0,.25);
  border-radius:8px; padding:4px 6px;
}

/* carta en hueco */
.card.in-slot{
  width:100%; height:100%; border-radius: calc(var(--radius) - 2px);
  animation: dropBounce 240ms ease;
}
.card.in-slot .card-inner{ padding: clamp(6px, 1vw, 8px) }
@keyframes dropBounce{ 0%{transform:scale(.9)} 55%{transform:scale(1.02)} 100%{transform:scale(1)} }
.card.in-slot .number{ font-size: clamp(1rem, 2.4vw, 1.6rem) }

/* clon / ghost mientras arrastras */
.card.fly{
  position:fixed; pointer-events:none; z-index:1000;
  will-change: transform; transition: none;
}

/* mano */
.hand-wrap{max-width:min(1100px, 98vw); margin:0 auto clamp(14px, 3vh, 28px); padding: 0 clamp(10px, 2.6vw, 24px)}
.hand-title{margin: 6px 0; font-size: clamp(.9rem, 2vw, 1rem); opacity:.85}
.hand{display:flex;flex-wrap:wrap;gap: clamp(8px, 1.6vw, 12px); min-height: calc(var(--card-h) + 16px)}
.turn-indicator{margin-top:6px;opacity:.85; font-size: clamp(.9rem, 2vw, 1rem)}

/* overlay final */
.overlay{position:fixed;inset:0;background:rgba(0,0,0,.6);display:grid;place-items:center;z-index:30}
.overlay.hidden{display:none}
.overlay-card{background:#11281b;border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:22px;width:min(90vw,420px);text-align:center;box-shadow:var(--shadow)}
.overlay-card h2{margin:0 0 8px}
.overlay-card p{margin:0 0 16px;opacity:.9}
.btn{background:var(--accent);color:#042312;font-weight:800;border:none;border-radius:12px;padding:10px 14px;cursor:pointer;box-shadow:var(--shadow);font-size:clamp(.9rem, 2vw, 1rem)}
.btn:hover{filter:brightness(1.05)}

/* --- ZOOM DE CARTA --- */
.zoom{
  position:fixed;inset:0; display:grid;place-items:center;
  background:rgba(0,0,0,.55); z-index:25;
}
.zoom.hidden{display:none}
.zoom-card{
  width:min(90vw,420px); height:min(92vh,540px);
  border-radius:20px; padding:16px; background:var(--card);
  border:2px solid var(--card-edge); box-shadow:var(--shadow);
  display:flex; flex-direction:column; justify-content:space-between;
  animation:zoomIn 160ms ease; position:relative; overflow:hidden;
}
.zoom-card img{
  position:absolute; inset:16px;
  width:auto;height:auto; max-width:calc(100% - 32px); max-height:calc(100% - 32px);
  object-fit:contain !important; object-position:center center !important;
  border-radius:12px; z-index:1; pointer-events:none;
}
.zoom-card::after{
  content:""; position:absolute;inset:0;z-index:1; border-radius:20px;
  background:linear-gradient(180deg,rgba(0,0,0,.12),rgba(0,0,0,.35));
}
.zoom-card .title,.zoom-card .number,.zoom-card .tag,.zoom-card .btn{ position:relative; z-index:2; }
.zoom-card .title{
  font-weight:800; font-size: clamp(1rem, 2.4vw, 1.2rem); text-align:center;
  padding-right: clamp(34px, 9vw, 56px); /* reserva mayor en zoom */
}
.zoom-card .number{
  position:absolute; top:16px; right:16px;
  font-size: clamp(1.6rem, 4vw, 2rem);
  background:rgba(0,0,0,.35); padding:6px 10px; border-radius:10px; line-height:1; font-weight:900;
}
@keyframes zoomIn{ from{transform:scale(.9);opacity:0} to{transform:scale(1);opacity:1} }

/* --- Ajustes responsive --- */
@media (max-width: 880px){
  :root{ --card-w: min(clamp(80px, 24vw, 110px), clamp(80px, 28vh, 110px)); }
  .lane{ gap: clamp(6px, 2vw, 12px); padding: clamp(6px, 2vw, 12px) }
}
@media (max-height: 420px){
  :root{ --card-w: min(84px, 16vw) }
  .topbar{ padding:6px 10px }
  .rule{ display:none }
}