:root{
  /* Escala base responsive */
  --card-w: clamp(92px, 14vw, 120px);
  --card-h: calc(var(--card-w) * 1.333); /* proporción 3:4 */
  --slot-h: clamp(90px, 13vw, 140px);
  --gap: clamp(6px, 1.6vw, 18px);

  --bg:#0e1a12;
  --felt:#14341f;
  --felt-2:#0f2a19;
  --ink:#eaf6ed;
  --muted:#cfe5d4;
  --accent:#7be495;
  --danger:#ff8a8a;
  --slot:#1e3b28;
  --card:#173b2a;
  --card-edge:#2a6d4a;
  --shadow: 0 8px 24px rgba(0,0,0,.35);
}

/* --- layout general --- */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  color:var(--ink);
  background:
    radial-gradient(1200px 600px at 50% -200px, #1d4d33 0%, transparent 60%),
    linear-gradient(180deg, var(--bg), #0b1410 60%, #080f0b);
}

/* Aviso de orientación */
.rotate-overlay{
  position:fixed; inset:0; z-index:100;
  display:grid; place-items:center;
  background:rgba(0,0,0,.7);
}
.rotate-overlay.hidden{ display:none }
.rotate-card{
  background:#11281b; border:1px solid rgba(255,255,255,.15);
  border-radius:16px; padding:22px; width:min(90vw, 420px);
  text-align:center; box-shadow:var(--shadow);
}
.rotate-card .rot-icon{ font-size:2.4rem; margin-bottom:8px; opacity:.9 }

/* --- cartel de turno --- */
.turn-banner{
  position:fixed;top:12px;left:50%;
  transform:translateX(-50%);
  background:rgba(0,0,0,.55);
  backdrop-filter:blur(4px);
  border:1px solid rgba(255,255,255,.15);
  color:var(--ink);
  padding:8px 12px;
  border-radius:12px;
  font-weight:800;
  letter-spacing:.4px;
  z-index:20;
  opacity:0;
  transition:opacity .25s ease, transform .25s ease;
  font-size: clamp(.9rem, 2.2vw, 1rem);
}
.turn-banner.show{opacity:1;transform:translateX(-50%)}
.hidden{display:none}

/* --- topbar --- */
.topbar{
  display:grid;
  grid-template-columns:1fr auto 1fr;
  align-items:center;
  gap:12px;
  padding:12px clamp(12px,3vw,28px);
  border-bottom:1px solid rgba(255,255,255,.06);
  background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,0));
  position:sticky;top:0;z-index:5;
}
.side{display:flex;align-items:center;gap:10px}
.side-right{justify-content:flex-end}
.name{opacity:.9;letter-spacing:.3px; font-size: clamp(.9rem, 2.2vw, 1rem) }

.pollution{
  width: clamp(44px, 6vw, 56px);
  height: clamp(44px, 6vw, 56px);
  border-radius:50%;
  display:grid;place-items:center;
  background:radial-gradient(circle at 30% 30%, #2c6b49, #123822);
  box-shadow:inset 0 0 0 3px var(--accent),var(--shadow);
  font-weight:700;font-variant-numeric:tabular-nums;
}
.pollution.hit{animation:pop 420ms ease}
@keyframes pop{0%{transform:scale(1)}40%{transform:scale(1.12)}100%{transform:scale(1)}}

.timer-wrap{text-align:center}
.timer-label{opacity:.8; font-size: clamp(.8rem, 2vw, .95rem) }
#timer{font-size: clamp(1.2rem, 3.6vw, 1.8rem); font-weight:800; letter-spacing:.5px}
.rule{opacity:.75; font-size: clamp(.7rem, 1.8vw, .85rem) }

/* --- tablero --- */
.board{
  max-width:min(1100px, 98vw);
  margin: clamp(6px, 2.4vw, 24px) auto;
  background:radial-gradient(900px 500px at 50% -120px,var(--felt),var(--felt-2));
  border-radius:20px;
  padding: clamp(8px, 2.4vw, 24px);
  box-shadow:var(--shadow);
  border:1px solid rgba(255,255,255,.06);
}
.lane{
  display:grid;
  grid-template-columns: repeat(5, 1fr);
  gap: var(--gap);
  padding: var(--gap);
}
.slot{
  position:relative;
  height: var(--slot-h);
  border-radius:14px;
  background:linear-gradient(180deg, rgba(255,255,255,.06), transparent 40%),linear-gradient(0deg, rgba(0,0,0,.25), rgba(0,0,0,.1));
  outline:2px dashed rgba(255,255,255,.12);
  outline-offset:-8px;
  display:grid;place-items:center;
  color:var(--muted);
  user-select:none;
  overflow:hidden;
}
.slot.own-target{outline-color:var(--accent);filter:drop-shadow(0 0 10px rgba(123,228,149,.35))}
.slot.enemy-target{outline-color:var(--danger)}
.slot.flash{animation:slotFlash 420ms ease}
@keyframes slotFlash{0%{box-shadow:0 0 0 0 rgba(123,228,149,0)}40%{box-shadow:0 0 18px 6px rgba(123,228,149,.45)}100%{box-shadow:0 0 0 0 rgba(123,228,149,0)}}

/* --- carta --- */
.card{
  position:relative;
  background:var(--card);
  border:2px solid var(--card-edge);
  color:var(--ink);
  width: var(--card-w);
  height: var(--card-h);
  border-radius:14px;
  box-shadow:var(--shadow);
  cursor:pointer;
  outline:3px solid transparent;
  user-select:none;
  transition:transform .12s ease, box-shadow .12s ease, outline-color .12s ease;
  display:flex;
  overflow:hidden;
}
.card:hover{transform:translateY(-4px)}
.card.selected{outline-color:var(--accent);transform:translateY(-6px)}

/* contenido interno */
.card-inner{
  position:relative;
  display:flex;flex-direction:column;
  justify-content:space-between;
  padding:10px;
  width:100%;height:100%;
}

/* imagen dentro de carta (centrada en mano, izquierda en tablero) */
.card-img{
  position:absolute;
  inset:10px;
  width:auto;height:auto;
  max-width:calc(100% - 20px);
  max-height:calc(100% - 20px);
  object-fit:contain;
  object-position:center center;
  border-radius:8px;
  z-index:1;
  pointer-events:none;
}
.card.in-slot .card-img{
  object-fit:cover;
  object-position:left center;
}

/* velo para legibilidad */
.card.has-image::after{
  content:"";
  position:absolute;inset:0; z-index:1;
  border-radius:14px;
  background:linear-gradient(180deg,rgba(0,0,0,.12),rgba(0,0,0,.35));
}

/* texto por encima */
.card .title,.card .number,.card .tag{ position:relative; z-index:2 }
.card .title{ font-weight:700; font-size: clamp(.9rem, 2.3vw, 1rem) }

/* número arriba-derecha para tapar poco */
.card .number{
  position:absolute; top:10px; right:10px;
  font-size: clamp(1rem, 2.8vw, 1.6rem);
  font-weight:900; line-height:1;
  background:rgba(0,0,0,.35); padding:4px 8px;
  border-radius:8px; font-variant-numeric:tabular-nums;
}
.card.in-slot .number{ font-size: clamp(1rem, 2.6vw, 1.6rem) }

/* etiqueta */
.card .tag{
  font-size: clamp(.68rem, 1.8vw, .8rem);
  opacity:.95;text-align:center;
  background:rgba(0,0,0,.25);
  border-radius:8px;padding:4px 6px;
}

/* carta en hueco */
.card.in-slot{
  width:100%; height:100%;
  border-radius:12px;
  animation:dropBounce 240ms ease;
  overflow:hidden;
}
.card.in-slot .card-inner{ padding:8px }
@keyframes dropBounce{
  0%{transform:scale(.9)}
  55%{transform:scale(1.02)}
  100%{transform:scale(1)}
}

/* clon animado */
.card.fly{position:fixed;pointer-events:none;transition:transform 220ms ease,opacity 220ms ease;z-index:15}

/* mano */
.hand-wrap{max-width:min(1100px, 98vw); margin:0 auto 28px; padding:0 clamp(12px,2.8vw,28px)}
.hand-title{margin:8px 0 6px; font-size: clamp(.9rem, 2.2vw, 1rem); opacity:.85}
.hand{display:flex;flex-wrap:wrap;gap:12px;min-height: calc(var(--card-h) + 16px) }
.turn-indicator{margin-top:6px;opacity:.85}

/* overlay final */
.overlay{position:fixed;inset:0;background:rgba(0,0,0,.6);display:grid;place-items:center;z-index:30}
.overlay.hidden{display:none}
.overlay-card{background:#11281b;border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:22px;width:min(90vw,420px);text-align:center;box-shadow:var(--shadow)}
.overlay-card h2{margin:0 0 8px}
.overlay-card p{margin:0 0 16px;opacity:.9}
.btn{background:var(--accent);color:#042312;font-weight:800;border:none;border-radius:12px;padding:10px 14px;cursor:pointer;box-shadow:var(--shadow)}
.btn:hover{filter:brightness(1.05)}

/* --- ZOOM (misma comp. que en mano) --- */
.zoom{
  position:fixed;inset:0;
  display:grid;place-items:center;
  background:rgba(0,0,0,.55);
  z-index:25;
}
.zoom.hidden{display:none}
.zoom-card{
  width:min(80vw,340px);
  height:min(86vh,520px);
  border-radius:20px;
  padding:16px;
  background:var(--card);
  border:2px solid var(--card-edge);
  box-shadow:var(--shadow);
  display:flex;
  flex-direction:column;
  justify-content:space-between;
  animation:zoomIn 160ms ease;
  position:relative;
  overflow:hidden;
}
.zoom-card img{
  position:absolute;
  inset:16px;
  width:auto;height:auto;
  max-width:calc(100% - 32px);
  max-height:calc(100% - 32px);
  object-fit:contain;
  object-position:center center;
  border-radius:12px;
  z-index:1;
  pointer-events:none;
}
.zoom-card::after{
  content:""; position:absolute; inset:0; z-index:1;
  border-radius:20px;
  background:linear-gradient(180deg,rgba(0,0,0,.12),rgba(0,0,0,.35));
}
.zoom-card .title,
.zoom-card .number,
.zoom-card .tag,
.zoom-card .btn{ position:relative; z-index:2 }
.zoom-card .number{
  position:absolute; top:16px; right:16px;
  font-size: clamp(1.4rem, 4.6vw, 2rem);
  background:rgba(0,0,0,.35);
  padding:6px 10px; border-radius:10px; line-height:1; font-weight:900;
}
@keyframes zoomIn{ from{transform:scale(.9);opacity:0} to{transform:scale(1);opacity:1} }

/* --- Ajustes para pantallas pequeñas en horizontal --- */
@media (max-height: 520px) and (orientation: landscape){
  :root{
    --card-w: clamp(86px, 12.5vw, 110px);
    --card-h: calc(var(--card-w) * 1.333);
    --slot-h: clamp(80px, 12vw, 120px);
  }
  .topbar{ padding: 8px clamp(8px, 2vw, 16px); }
  .board{ padding: clamp(6px, 1.8vw, 16px); }
  .lane{ gap: clamp(4px, 1.2vw, 12px); padding: clamp(4px, 1.2vw, 12px); }
}

/* --- Reducciones extra en móviles muy pequeños --- */
@media (max-width: 740px){
  .name{ display:none } /* ahorrar espacio en topbar */
  .rule{ display:none }
}

/* No mostramos nada especial aquí; el JS enseña overlay en vertical */